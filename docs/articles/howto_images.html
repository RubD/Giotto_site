<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • Giotto</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="Giotto">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-109153024-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-109153024-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Giotto</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Start
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting_started.html#description">Description</a>
    </li>
    <li>
      <a href="../articles/getting_started.html#workflow-diagram">Workflow</a>
    </li>
    <li>
      <a href="../articles/getting_started.html#howtos">HOWTOs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Datasets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mini_seqfish.html">mini seqFISH</a>
    </li>
    <li>
      <a href="../articles/mini_visium.html">mini visium (spots)</a>
    </li>
    <li>
      <a href="../articles/mini_starmap.html">mini 3D STARmap</a>
    </li>
    <li>
      <a href="../articles/mouse_seqFISH_cortex_200914.html">mouse seqFISH cortex</a>
    </li>
    <li>
      <a href="../articles/mouse_merFISH_preoptic_region_200909.html">mouse hypoth. preopt. region</a>
    </li>
    <li>
      <a href="../articles/mouse_starmap_cortex_200917.html">mouse STARmap cortex</a>
    </li>
    <li>
      <a href="../articles/human_cycif_PDAC_200916.html">human CyCIF PDAC</a>
    </li>
    <li>
      <a href="../articles/mouse_visium_brain_201226.html">mouse Visium brain</a>
    </li>
    <li>
      <a href="../articles/mouse_visium_kidney_200916.html">mouse Visium kidney</a>
    </li>
    <li>
      <a href="../articles/mouse_CODEX_spleen_200921.html">mouse CODEX spleen</a>
    </li>
    <li>
      <a href="../articles/mouse_osmFISH_SScortex_200915.html">mouse osmFISH SScortex</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/contribute.html">Contribute</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    FAQ
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/faqs.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../articles/github_issues.html">GitHub Issues Guidelines</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Try Giotto
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/docker.html">Docker</a>
    </li>
    <li>
      <a href="../articles/binder.html">Binder</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/RubD/Giotto">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RubD/Giotto/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="howto_images_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RubD/Giotto/blob/master/vignettes/howto_images.Rmd"><code>vignettes/howto_images.Rmd</code></a></small>
      <div class="hidden name"><code>howto_images.Rmd</code></div>

    </div>

    
    
<div id="how-to-work-with-background-images" class="section level1">
<h1 class="hasAnchor">
<a href="#how-to-work-with-background-images" class="anchor"></a>How to work with background images?</h1>
<p>All spatial visualization functions in the Giotto toolbox can be overlaid on a background image. This allows you to visualize your results on top of the original tissue image. We provide multiple ways of adding and modifying figures in Giotto. In short there are 3 things to consider:</p>
<ol style="list-style-type: decimal">
<li>how to add an image to a Giotto object?<br>
</li>
</ol>
<ul>
<li>
<strong>createGiottoVisiumObject</strong> can be used directly for a visium 10X dataset<br>
</li>
<li>
<strong>createGiottoImage</strong> can be used to create a Giotto image object from a magick image object<br>
</li>
<li>
<strong>addGiottoImage</strong> this add a Giotto image to your Giotto object<br>
</li>
<li>
<strong>updateGiottoImage</strong> this helps to adjust the alignment of your image with your results</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>how to modify an image? e.g. change background color<br>
</li>
</ol>
<ul>
<li>
<strong>estimateImageBg</strong> function to estimage the background color of your Giotto or magick image</li>
<li>
<strong>changeImageBg</strong> function to change the background color of your image</li>
<li>
<strong>plotGiottoImage</strong> function to plot an image by itself</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>how to show these images with your spatial plots?</li>
</ol>
<ul>
<li>
<strong>showGiottoImageNames</strong> this tells you which giotto image(s) are part of your giotto object</li>
<li>Each spatial plotting function has the following 3 parameters:
<ul>
<li>show_image = TRUE or FALSE, to show a background image or not<br>
</li>
<li>image_name = name of associated Giotto image to use for the background image (option 1)</li>
<li>gimage = a giotto image object to use (option 2)</li>
</ul>
</li>
<li>
<strong>addGiottoImageToSpatPlot</strong> to test your giotto images you can use this function to them to spatPlot result</li>
</ul>
<p>Here we process the Visium Kidney dataset to illustrate all the different and flexible ways to deal with images:</p>
<div id="create-giotto-giotto-object" class="section level2">
<h2 class="hasAnchor">
<a href="#create-giotto-giotto-object" class="anchor"></a>1. create Giotto Giotto object</h2>
<p>Here we use the wrapper function createGiottoVisiumObject to create a Giotto object for a 10X Visium dataset, which includes a png image.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rubd.github.io/Giotto/">Giotto</a></span><span class="op">)</span>

<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/createGiottoVisiumObject.html">createGiottoVisiumObject</a></span><span class="op">(</span>visium_dir <span class="op">=</span> <span class="st">'/path/to/Visium_data/Kidney_data'</span>,
                                         png_name <span class="op">=</span> <span class="st">'tissue_lowres_image.png'</span>, gene_column_index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
</div>
<div id="align-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#align-plot" class="anchor"></a>2. align plot</h2>
<p>The image plot and the Giotto results are not always perfectly aligned. This step just needs to be done once.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># output from Giotto</span>
<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_a_spatplot.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># problem: image is not perfectly aligned</span>
<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_b_spatplot_image.png" style="width:50.0%"></p>
<p>adjust the x and y minima and maxima to align the image and the giotto output results:</p>
<div id="alignment-insights" class="section level3">
<h3 class="hasAnchor">
<a href="#alignment-insights" class="anchor"></a>Alignment insights</h3>
<div id="x-and-y-control" class="section level4">
<h4 class="hasAnchor">
<a href="#x-and-y-control" class="anchor"></a>x and y control</h4>
<p>We can use <strong>updateGiottoImage</strong> and <strong>spatPlot</strong> in an iterative manner to see how changing the x and y minima and maxima affect the image.</p>
<p>xmax_adj and xmin_adj: adjust the x location (in data coordinates) giving horizontal location of raster (offset values)<br>
ymax_adj and ymin_adj: adjust the y location (in data coordinates) giving vertical location of raster (offset values)</p>
<p>Without adjustment:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## no adjustment</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/updateGiottoImage.html">updateGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span>,
                                  xmax_adj <span class="op">=</span> <span class="fl">0</span>, xmin_adj <span class="op">=</span> <span class="fl">0</span>,
                                  ymax_adj <span class="op">=</span> <span class="fl">0</span>, ymin_adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_c_spatplot_image_adjusted_1.png" style="width:50.0%"></p>
<p>Adjustment to the right –&gt; with xmax_adj:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## adjust the image to right side with xmax_adj</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/updateGiottoImage.html">updateGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span>,
                                  xmax_adj <span class="op">=</span> <span class="fl">1000</span>, xmin_adj <span class="op">=</span> <span class="fl">0</span>,
                                  ymax_adj <span class="op">=</span> <span class="fl">0</span>, ymin_adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_c_spatplot_image_adjusted_2.png" style="width:50.0%"></p>
<p>Adjustment to the left &lt;– with xmin_adj:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## adjust to left side with xmin_adj</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/updateGiottoImage.html">updateGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span>,
                                  xmax_adj <span class="op">=</span> <span class="fl">0</span>, xmin_adj <span class="op">=</span> <span class="fl">1000</span>,
                                  ymax_adj <span class="op">=</span> <span class="fl">0</span>, ymin_adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_c_spatplot_image_adjusted_3.png" style="width:50.0%"></p>
<p>Adjustment to the top with ymax_adj:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## adjust to top side with ymax_adj</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/updateGiottoImage.html">updateGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span>,
                                  xmax_adj <span class="op">=</span> <span class="fl">0</span>, xmin_adj <span class="op">=</span> <span class="fl">0</span>,
                                  ymax_adj <span class="op">=</span> <span class="fl">1000</span>, ymin_adj <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_c_spatplot_image_adjusted_4.png" style="width:50.0%"></p>
<p>Adjustment to the bottom with ymin_adj:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## adjust to bottom side with ymin_adj</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/updateGiottoImage.html">updateGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span>,
                                  xmax_adj <span class="op">=</span> <span class="fl">0</span>, xmin_adj <span class="op">=</span> <span class="fl">0</span>,
                                  ymax_adj <span class="op">=</span> <span class="fl">0</span>, ymin_adj <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_c_spatplot_image_adjusted_5.png" style="width:50.0%"></p>
</div>
<div id="simulation-of-shifts" class="section level4">
<h4 class="hasAnchor">
<a href="#simulation-of-shifts" class="anchor"></a>Simulation of shifts</h4>
<p>Create an OK adjustment:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## OK alignment</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/updateGiottoImage.html">updateGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span>,
                                  xmax_adj <span class="op">=</span> <span class="fl">1000</span>, xmin_adj <span class="op">=</span> <span class="fl">1000</span>,
                                  ymax_adj <span class="op">=</span> <span class="fl">1000</span>, ymin_adj <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_c_spatplot_image_adjusted_6.png" style="width:50.0%"></p>
<p>Simulate a right shift and compare with the OK adjustment:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## simulate a right shift</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/updateGiottoImage.html">updateGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span>,
                                  xmax_adj <span class="op">=</span> <span class="fl">2000</span>, xmin_adj <span class="op">=</span> <span class="fl">500</span>,
                                  ymax_adj <span class="op">=</span> <span class="fl">1000</span>, ymin_adj <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_c_spatplot_image_adjusted_7.png" style="width:50.0%"></p>
<p>Simulate a left shift and compare with the OK adjustment:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## simulate a left shift</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/updateGiottoImage.html">updateGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span>,
                                  xmax_adj <span class="op">=</span> <span class="fl">500</span>, xmin_adj <span class="op">=</span> <span class="fl">2000</span>,
                                  ymax_adj <span class="op">=</span> <span class="fl">1000</span>, ymin_adj <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_c_spatplot_image_adjusted_8.png" style="width:50.0%"></p>
<p>Simulate a downward shift and compare with the OK adjustment:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## simulate a downward shift</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/updateGiottoImage.html">updateGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span>,
                                  xmax_adj <span class="op">=</span> <span class="fl">1000</span>, xmin_adj <span class="op">=</span> <span class="fl">1000</span>,
                                  ymax_adj <span class="op">=</span> <span class="fl">500</span>, ymin_adj <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_c_spatplot_image_adjusted_9.png" style="width:50.0%"></p>
<p>Simulate a upward shift and compare with the OK adjustment:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## simulate a upward shift</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/updateGiottoImage.html">updateGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span>,
                                  xmax_adj <span class="op">=</span> <span class="fl">1000</span>, xmin_adj <span class="op">=</span> <span class="fl">1000</span>,
                                  ymax_adj <span class="op">=</span> <span class="fl">2000</span>, ymin_adj <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_c_spatplot_image_adjusted_10.png" style="width:50.0%"></p>
</div>
<div id="a-good-alignment" class="section level4">
<h4 class="hasAnchor">
<a href="#a-good-alignment" class="anchor"></a>A good alignment</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># check name</span>
<span class="fu"><a href="../reference/showGiottoImageNames.html">showGiottoImageNames</a></span><span class="op">(</span><span class="va">visium_kidney</span><span class="op">)</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/updateGiottoImage.html">updateGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span>,
                            xmax_adj <span class="op">=</span> <span class="fl">1300</span>, xmin_adj <span class="op">=</span> <span class="fl">1200</span>,
                            ymax_adj <span class="op">=</span> <span class="fl">1100</span>, ymin_adj <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, show_image <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_c_spatplot_image_adjusted.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot original image</span>
<span class="fu"><a href="../reference/plotGiottoImage.html">plotGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, <span class="st">'image'</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/1_d_original_plot.png" style="width:50.0%"></p>
</div>
</div>
</div>
<div id="change-background-of-a-giotto-or-magick-image" class="section level2">
<h2 class="hasAnchor">
<a href="#change-background-of-a-giotto-or-magick-image" class="anchor"></a>3. change background of a Giotto or magick image</h2>
<p>extract the giotto image from your giotto object and then estimate the background of your image:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myimage</span> <span class="op">=</span> <span class="fu"><a href="../reference/getGiottoImage.html">getGiottoImage</a></span><span class="op">(</span><span class="va">visium_kidney</span>, image_name <span class="op">=</span> <span class="st">'image'</span><span class="op">)</span> <span class="co"># extract image to modify</span>
<span class="fu"><a href="../reference/estimateImageBg.html">estimateImageBg</a></span><span class="op">(</span>mg_object <span class="op">=</span> <span class="va">myimage</span>, top_color_range <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>  <span class="co"># estimate background (bg) color</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/2_a_background_colors.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## create and test black background</span>
<span class="va">orig_black_png</span> <span class="op">=</span> <span class="fu"><a href="../reference/changeImageBg.html">changeImageBg</a></span><span class="op">(</span>mg_object <span class="op">=</span> <span class="va">myimage</span>, bg_color <span class="op">=</span> <span class="st">'#949594'</span>, perc_range <span class="op">=</span> <span class="fl">10</span>, new_color <span class="op">=</span> <span class="st">'#000000'</span>, new_name <span class="op">=</span> <span class="st">'black_bg'</span><span class="op">)</span>

<span class="va">mypl</span> <span class="op">=</span> <span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, return_plot <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">mypl_image</span> <span class="op">=</span> <span class="fu"><a href="../reference/addGiottoImageToSpatPlot.html">addGiottoImageToSpatPlot</a></span><span class="op">(</span><span class="va">mypl</span>, <span class="va">orig_black_png</span><span class="op">)</span>
<span class="va">mypl_image</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/2_b_black_background.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## create and test white background</span>
<span class="va">orig_white_png</span> <span class="op">=</span> <span class="fu"><a href="../reference/changeImageBg.html">changeImageBg</a></span><span class="op">(</span>mg_object <span class="op">=</span> <span class="va">myimage</span>, bg_color <span class="op">=</span> <span class="st">'#949594'</span>, perc_range <span class="op">=</span> <span class="fl">10</span>, new_color <span class="op">=</span> <span class="st">'#FFFFFF'</span>, new_name <span class="op">=</span> <span class="st">'white_bg'</span><span class="op">)</span>

<span class="va">mypl</span> <span class="op">=</span> <span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'in_tissue'</span>, return_plot <span class="op">=</span> <span class="cn">T</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">mypl_image</span> <span class="op">=</span> <span class="fu"><a href="../reference/addGiottoImageToSpatPlot.html">addGiottoImageToSpatPlot</a></span><span class="op">(</span><span class="va">mypl</span>, <span class="va">orig_white_png</span><span class="op">)</span>
<span class="va">mypl_image</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/2_c_white_background.png" style="width:50.0%"></p>
</div>
<div id="add-image-from-scratch" class="section level2">
<h2 class="hasAnchor">
<a href="#add-image-from-scratch" class="anchor"></a>4. Add image from scratch</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## use magick library to load (and optionally modify) figure ##</span>
<span class="co"># original image</span>
<span class="va">png_path</span> <span class="op">=</span> <span class="st">'/your/data/path/Visium_data/Kidney_data/spatial/tissue_lowres_image.png'</span>
<span class="va">mg_img</span> <span class="op">=</span> <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html">image_read</a></span><span class="op">(</span><span class="va">png_path</span><span class="op">)</span></code></pre></div>
<p>create a negated image</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># original image negated</span>
<span class="va">mg_img2</span> <span class="op">=</span> <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/effects.html">image_negate</a></span><span class="op">(</span><span class="va">mg_img</span><span class="op">)</span>
<span class="va">orig_neg_png</span> <span class="op">=</span> <span class="fu"><a href="../reference/createGiottoImage.html">createGiottoImage</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, mg_object <span class="op">=</span> <span class="va">mg_img2</span>, name <span class="op">=</span> <span class="st">'image_neg'</span>,
                                 xmax_adj <span class="op">=</span> <span class="fl">1300</span>, xmin_adj <span class="op">=</span> <span class="fl">1200</span>, ymax_adj <span class="op">=</span> <span class="fl">1100</span>, ymin_adj <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">mypl_image</span> <span class="op">=</span> <span class="fu"><a href="../reference/addGiottoImageToSpatPlot.html">addGiottoImageToSpatPlot</a></span><span class="op">(</span><span class="va">mypl</span>, <span class="va">orig_neg_png</span><span class="op">)</span>
<span class="va">mypl_image</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/3_a_external_image_negated.png" style="width:50.0%"></p>
<p>create a charcoal image</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># charcoal image (black/white)</span>
<span class="va">mg_img3</span> <span class="op">=</span> <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/effects.html">image_charcoal</a></span><span class="op">(</span><span class="va">mg_img</span>, radius <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">mg_img3</span> <span class="op">=</span> <span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html">image_convert</a></span><span class="op">(</span><span class="va">mg_img3</span>, colorspace <span class="op">=</span> <span class="st">'rgb'</span><span class="op">)</span>
<span class="va">orig_charc_png</span> <span class="op">=</span> <span class="fu"><a href="../reference/createGiottoImage.html">createGiottoImage</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, mg_object <span class="op">=</span> <span class="va">mg_img3</span>, name <span class="op">=</span> <span class="st">'image_charc'</span>,
                                   xmax_adj <span class="op">=</span> <span class="fl">1300</span>, xmin_adj <span class="op">=</span> <span class="fl">1200</span>, ymax_adj <span class="op">=</span> <span class="fl">1100</span>, ymin_adj <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">mypl_image</span> <span class="op">=</span> <span class="fu"><a href="../reference/addGiottoImageToSpatPlot.html">addGiottoImageToSpatPlot</a></span><span class="op">(</span><span class="va">mypl</span>, <span class="va">orig_charc_png</span><span class="op">)</span>
<span class="va">mypl_image</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/3_b_external_image_charcoal.png" style="width:50.0%"></p>
<p>add multiple new images to your giotto object</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## add images to Giotto object ##</span>
<span class="va">image_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">orig_white_png</span>, <span class="va">orig_black_png</span>, <span class="va">orig_neg_png</span>, <span class="va">orig_charc_png</span><span class="op">)</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/addGiottoImage.html">addGiottoImage</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>,
                               images <span class="op">=</span> <span class="va">image_list</span><span class="op">)</span>
<span class="fu"><a href="../reference/showGiottoImageNames.html">showGiottoImageNames</a></span><span class="op">(</span><span class="va">visium_kidney</span><span class="op">)</span> <span class="co"># shows which Giotto images are attached to you Giotto object</span></code></pre></div>
</div>
<div id="example-kidney-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#example-kidney-analysis" class="anchor"></a>5. Example Kidney analysis</h2>
<div id="processing" class="section level4">
<h4 class="hasAnchor">
<a href="#processing" class="anchor"></a>5.1 processing</h4>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## subset on spots that were covered by tissue</span>
<span class="va">metadata</span> <span class="op">=</span> <span class="fu"><a href="../reference/pDataDT.html">pDataDT</a></span><span class="op">(</span><span class="va">visium_kidney</span><span class="op">)</span>
<span class="va">in_tissue_barcodes</span> <span class="op">=</span> <span class="va">metadata</span><span class="op">[</span><span class="va">in_tissue</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="va">cell_ID</span>
<span class="va">visium_kidney</span> <span class="op">=</span> <span class="fu"><a href="../reference/subsetGiotto.html">subsetGiotto</a></span><span class="op">(</span><span class="va">visium_kidney</span>, cell_ids <span class="op">=</span> <span class="va">in_tissue_barcodes</span><span class="op">)</span>

<span class="co">## filter</span>
<span class="va">visium_kidney</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filterGiotto.html">filterGiotto</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>,
                              expression_threshold <span class="op">=</span> <span class="fl">1</span>,
                              gene_det_in_min_cells <span class="op">=</span> <span class="fl">50</span>,
                              min_det_genes_per_cell <span class="op">=</span> <span class="fl">1000</span>,
                              expression_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'raw'</span><span class="op">)</span>,
                              verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="co">## normalize</span>
<span class="va">visium_kidney</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalizeGiotto.html">normalizeGiotto</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, scalefactor <span class="op">=</span> <span class="fl">6000</span>, verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="co">## add gene &amp; cell statistics</span>
<span class="va">visium_kidney</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addStatistics.html">addStatistics</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span><span class="op">)</span>
<span class="co">## visualize</span>
<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/4_a_spatial_locations.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'nr_genes'</span>, color_as_factor <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/4_b_nr_genes.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add black background image</span>
<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, show_image <span class="op">=</span> <span class="cn">T</span>, image_name <span class="op">=</span> <span class="st">"black_bg"</span>,
           cell_color <span class="op">=</span> <span class="st">'nr_genes'</span>, color_as_factor <span class="op">=</span> <span class="cn">F</span>, point_alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/4_c_nr_genes_black_bg.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## alternative: directly provide a gimage (giotto image object), this will override the the image_name param</span>
<span class="fu"><a href="../reference/spatPlot.html">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, show_image <span class="op">=</span> <span class="cn">T</span>, gimage <span class="op">=</span> <span class="va">orig_charc_png</span>,
           cell_color <span class="op">=</span> <span class="st">'nr_genes'</span>, color_as_factor <span class="op">=</span> <span class="cn">F</span>, point_alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/4_d_nr_genes_charc_bg.png" style="width:50.0%"></p>
</div>
<div id="dimension-reduction" class="section level4">
<h4 class="hasAnchor">
<a href="#dimension-reduction" class="anchor"></a>5.2 dimension reduction</h4>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## highly variable genes (HVG)</span>
<span class="va">visium_kidney</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculateHVG.html">calculateHVG</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, nr_expression_groups <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="co">## select genes based on HVG and gene statistics, both found in gene metadata</span>
<span class="va">gene_metadata</span> <span class="op">=</span> <span class="fu"><a href="../reference/fDataDT.html">fDataDT</a></span><span class="op">(</span><span class="va">visium_kidney</span><span class="op">)</span>
<span class="va">featgenes</span> <span class="op">=</span> <span class="va">gene_metadata</span><span class="op">[</span><span class="va">hvg</span> <span class="op">==</span> <span class="st">'yes'</span> <span class="op">&amp;</span> <span class="va">perc_cells</span> <span class="op">&gt;</span> <span class="fl">4</span> <span class="op">&amp;</span> <span class="va">mean_expr_det</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">]</span><span class="op">$</span><span class="va">gene_ID</span>

<span class="co">## run PCA on expression values (default)</span>
<span class="va">visium_kidney</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPCA.html">runPCA</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, genes_to_use <span class="op">=</span> <span class="va">featgenes</span><span class="op">)</span>

<span class="co">## run UMAP and tSNE on PCA space (default)</span>
<span class="va">visium_kidney</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runUMAP.html">runUMAP</a></span><span class="op">(</span><span class="va">visium_kidney</span>, dimensions_to_use <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotUMAP.html">plotUMAP</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/5_c_UMAP_reduction.png" style="width:50.0%"></p>
</div>
<div id="cluster" class="section level4">
<h4 class="hasAnchor">
<a href="#cluster" class="anchor"></a>5.3 cluster</h4>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## sNN network (default)</span>
<span class="va">visium_kidney</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createNearestNetwork.html">createNearestNetwork</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, dimensions_to_use <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, k <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>
<span class="co">## Leiden clustering</span>
<span class="va">visium_kidney</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/doLeidenCluster.html">doLeidenCluster</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, resolution <span class="op">=</span> <span class="fl">0.4</span>, n_iterations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotUMAP.html">plotUMAP</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>,
         cell_color <span class="op">=</span> <span class="st">'leiden_clus'</span>, show_NN_network <span class="op">=</span> <span class="cn">T</span>, point_size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/6_a_UMAP_leiden.png" style="width:50.0%"></p>
</div>
<div id="co-visualize" class="section level4">
<h4 class="hasAnchor">
<a href="#co-visualize" class="anchor"></a>5.4 co-visualize</h4>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># expression and spatial</span>
<span class="fu"><a href="../reference/showGiottoImageNames.html">showGiottoImageNames</a></span><span class="op">(</span><span class="va">visium_kidney</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatDimPlot.html">spatDimPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'leiden_clus'</span>,
            show_image <span class="op">=</span> <span class="cn">T</span>, image_name <span class="op">=</span> <span class="st">'black_bg'</span>,
            dim_point_size <span class="op">=</span> <span class="fl">2</span>, spat_point_size <span class="op">=</span> <span class="fl">2.5</span>,
            save_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>save_name <span class="op">=</span> <span class="st">'7_a_covis_leiden_black'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/7_a_covis_leiden_black.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spatDimPlot.html">spatDimPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'leiden_clus'</span>,
            show_image <span class="op">=</span> <span class="cn">T</span>, image_name <span class="op">=</span> <span class="st">'image_neg'</span>,
            dim_point_size <span class="op">=</span> <span class="fl">2</span>, spat_point_size <span class="op">=</span> <span class="fl">2.5</span>,
            save_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>save_name <span class="op">=</span> <span class="st">'7_b_covis_leiden_negated'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/7_b_covis_leiden_negated.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spatDimPlot.html">spatDimPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_kidney</span>, cell_color <span class="op">=</span> <span class="st">'leiden_clus'</span>,
            show_image <span class="op">=</span> <span class="cn">T</span>, image_name <span class="op">=</span> <span class="st">'image_charc'</span>,
            dim_point_size <span class="op">=</span> <span class="fl">2</span>, spat_point_size <span class="op">=</span> <span class="fl">2.5</span>,
            save_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>save_name <span class="op">=</span> <span class="st">'7_b_covis_leiden_charc'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/7_b_covis_leiden_charc.png" style="width:50.0%"></p>
</div>
<div id="spatial-gene-plots" class="section level4">
<h4 class="hasAnchor">
<a href="#spatial-gene-plots" class="anchor"></a>5.5 spatial gene plots</h4>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## gene plots ##</span>
<span class="fu"><a href="../reference/spatGenePlot.html">spatGenePlot</a></span><span class="op">(</span><span class="va">visium_kidney</span>, show_image <span class="op">=</span> <span class="cn">T</span>, image_name <span class="op">=</span> <span class="st">'image_charc'</span>,
             expression_values <span class="op">=</span> <span class="st">'scaled'</span>, point_size <span class="op">=</span> <span class="fl">2</span>, 
             genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Lrp2'</span>, <span class="st">'Sptssb'</span>, <span class="st">'Slc12a3'</span><span class="op">)</span>,  cow_n_col <span class="op">=</span> <span class="fl">2</span>, 
             cell_color_gradient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'darkblue'</span>, <span class="st">'white'</span>, <span class="st">'red'</span><span class="op">)</span>, gradient_midpoint <span class="op">=</span> <span class="fl">0</span>, point_alpha <span class="op">=</span> <span class="fl">0.8</span>,
             save_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>save_name <span class="op">=</span> <span class="st">'8_a_spatgene_charc'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/8_a_spatgene_charc.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spatGenePlot.html">spatGenePlot</a></span><span class="op">(</span><span class="va">visium_kidney</span>, show_image <span class="op">=</span> <span class="cn">T</span>, image_name <span class="op">=</span> <span class="st">'image_charc'</span>,
             expression_values <span class="op">=</span> <span class="st">'scaled'</span>, point_size <span class="op">=</span> <span class="fl">2</span>, point_shape <span class="op">=</span> <span class="st">'voronoi'</span>,
             genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Lrp2'</span>, <span class="st">'Sptssb'</span>, <span class="st">'Slc12a3'</span><span class="op">)</span>,  cow_n_col <span class="op">=</span> <span class="fl">2</span>, 
             cell_color_gradient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'darkblue'</span>, <span class="st">'white'</span>, <span class="st">'red'</span><span class="op">)</span>, gradient_midpoint <span class="op">=</span> <span class="fl">0</span>, vor_alpha <span class="op">=</span> <span class="fl">0.8</span>,
             save_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>save_name <span class="op">=</span> <span class="st">'8_b_spatgene_charc_vor'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/8_b_spatgene_charc_vor.png" style="width:50.0%"></p>
</div>
<div id="subset-plots" class="section level4">
<h4 class="hasAnchor">
<a href="#subset-plots" class="anchor"></a>5.6 subset plots</h4>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">visium_kidney_subset</span> <span class="op">=</span> <span class="fu"><a href="../reference/subsetGiottoLocs.html">subsetGiottoLocs</a></span><span class="op">(</span><span class="va">visium_kidney</span>, x_min <span class="op">=</span> <span class="fl">3000</span>, x_max <span class="op">=</span> <span class="fl">5500</span>, y_min <span class="op">=</span> <span class="op">-</span><span class="fl">10000</span>, y_max <span class="op">=</span> <span class="op">-</span><span class="fl">7000</span><span class="op">)</span>

<span class="fu"><a href="../reference/spatGenePlot.html">spatGenePlot</a></span><span class="op">(</span><span class="va">visium_kidney_subset</span>, show_image <span class="op">=</span> <span class="cn">T</span>, image_name <span class="op">=</span> <span class="st">'image_charc'</span>,
             expression_values <span class="op">=</span> <span class="st">'scaled'</span>, point_size <span class="op">=</span> <span class="fl">4</span>, 
             genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Lrp2'</span>, <span class="st">'Sptssb'</span>, <span class="st">'Slc12a3'</span><span class="op">)</span>,  cow_n_col <span class="op">=</span> <span class="fl">2</span>, 
             cell_color_gradient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'darkblue'</span>, <span class="st">'white'</span>, <span class="st">'red'</span><span class="op">)</span>, gradient_midpoint <span class="op">=</span> <span class="fl">0</span>,
             point_alpha <span class="op">=</span> <span class="fl">0.8</span>,
             save_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>save_name <span class="op">=</span> <span class="st">'9_a_subset_spatgene_charc'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/9_a_subset_spatgene_charc.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spatGenePlot.html">spatGenePlot</a></span><span class="op">(</span><span class="va">visium_kidney_subset</span>, show_image <span class="op">=</span> <span class="cn">T</span>, image_name <span class="op">=</span> <span class="st">'image_charc'</span>,
             expression_values <span class="op">=</span> <span class="st">'scaled'</span>, point_size <span class="op">=</span> <span class="fl">4</span>,  point_shape <span class="op">=</span> <span class="st">'voronoi'</span>, vor_alpha <span class="op">=</span> <span class="fl">0.5</span>,
             genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Lrp2'</span>, <span class="st">'Sptssb'</span>, <span class="st">'Slc12a3'</span><span class="op">)</span>,  cow_n_col <span class="op">=</span> <span class="fl">2</span>, 
             cell_color_gradient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'darkblue'</span>, <span class="st">'white'</span>, <span class="st">'red'</span><span class="op">)</span>, gradient_midpoint <span class="op">=</span> <span class="fl">0</span>,
             save_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>save_name <span class="op">=</span> <span class="st">'9_b_subset_spatgene_charc_vor'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/howtos/giotto_images/vignette_1/9_b_subset_spatgene_charc_vor.png" style="width:50.0%"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.drieslab.com/">Ruben Dries</a>, Qian Zhu, Huipeng Li, Rui Dong, Guo-Cheng Yuan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
